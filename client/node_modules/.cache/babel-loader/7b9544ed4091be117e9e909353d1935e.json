{"ast":null,"code":"import { Project } from \"./Project\";\nconst baseUrl = \"http://localhost:4000\";\nconst url = `${baseUrl}/projects`; // const url = `${baseUrl}/fail`;\n\nfunction translateStatusToErrorMessage(status) {\n  switch (status) {\n    case 401:\n      return \"Please login again.\";\n\n    case 403:\n      return \"You do not have permission to view the project(s).\";\n\n    default:\n      return \"There was an error retrieving the project(s). Please try again.\";\n  }\n}\n\nfunction checkStatus(response) {\n  if (response.ok) {\n    return response;\n  } else {\n    const httpErrorInfo = {\n      status: response.status,\n      statusText: response.statusText,\n      url: response.url\n    };\n    console.log(`log server http error: ${JSON.stringify(httpErrorInfo)}`);\n    let errorMessage = translateStatusToErrorMessage(httpErrorInfo.status);\n    throw new Error(errorMessage);\n  }\n}\n\nfunction parseJSON(response) {\n  return response.json();\n} // eslint-disable-next-line\n\n\nfunction delay(ms) {\n  return function (x) {\n    return new Promise(resolve => setTimeout(() => resolve(x), ms));\n  };\n}\n\nfunction convertToProjectModels(data) {\n  let projects = data.map(convertToProjectModel);\n  return projects;\n}\n\nfunction convertToProjectModel(item) {\n  return new Project(item);\n}\n\nconst projectAPI = {\n  get() {\n    let page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    let limit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 20;\n    return fetch(`${url}?_page=${page}&_limit=${limit}&_sort=name`) // .then(delay(600))\n    .then(checkStatus).then(parseJSON).then(convertToProjectModels).catch(error => {\n      console.log(\"log client error\" + error);\n      throw new Error(\"There was an error retrieving the projects. Try Again!\");\n    });\n  },\n\n  put(project) {\n    return fetch(`${url}/${project.id}`, {\n      method: \"PUT\",\n      body: JSON.stringify(project),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(checkStatus).then(parseJSON).catch(error => {\n      console.log(\"log client error \" + error);\n      throw new Error(\"There was an error updating the project. Please try again.\");\n    });\n  }\n\n};\nexport { projectAPI };","map":{"version":3,"names":["Project","baseUrl","url","translateStatusToErrorMessage","status","checkStatus","response","ok","httpErrorInfo","statusText","console","log","JSON","stringify","errorMessage","Error","parseJSON","json","delay","ms","x","Promise","resolve","setTimeout","convertToProjectModels","data","projects","map","convertToProjectModel","item","projectAPI","get","page","limit","fetch","then","catch","error","put","project","id","method","body","headers"],"sources":["C:/Users/irham/Sandbox/react-project/tutorial-keeptrack/src/projects/projectAPI.ts"],"sourcesContent":["import { Project } from \"./Project\";\r\nconst baseUrl = \"http://localhost:4000\";\r\nconst url = `${baseUrl}/projects`;\r\n// const url = `${baseUrl}/fail`;\r\n\r\nfunction translateStatusToErrorMessage(status: number) {\r\n\tswitch (status) {\r\n\t\tcase 401:\r\n\t\t\treturn \"Please login again.\";\r\n\t\tcase 403:\r\n\t\t\treturn \"You do not have permission to view the project(s).\";\r\n\t\tdefault:\r\n\t\t\treturn \"There was an error retrieving the project(s). Please try again.\";\r\n\t}\r\n}\r\n\r\nfunction checkStatus(response: any) {\r\n\tif (response.ok) {\r\n\t\treturn response;\r\n\t} else {\r\n\t\tconst httpErrorInfo = {\r\n\t\t\tstatus: response.status,\r\n\t\t\tstatusText: response.statusText,\r\n\t\t\turl: response.url,\r\n\t\t};\r\n\t\tconsole.log(`log server http error: ${JSON.stringify(httpErrorInfo)}`);\r\n\r\n\t\tlet errorMessage = translateStatusToErrorMessage(httpErrorInfo.status);\r\n\t\tthrow new Error(errorMessage);\r\n\t}\r\n}\r\n\r\nfunction parseJSON(response: Response) {\r\n\treturn response.json();\r\n}\r\n\r\n// eslint-disable-next-line\r\nfunction delay(ms: number) {\r\n\treturn function (x: any): Promise<any> {\r\n\t\treturn new Promise((resolve) => setTimeout(() => resolve(x), ms));\r\n\t};\r\n}\r\n\r\nfunction convertToProjectModels(data: any[]): Project[] {\r\n\tlet projects: Project[] = data.map(convertToProjectModel);\r\n\treturn projects;\r\n}\r\n\r\nfunction convertToProjectModel(item: any): Project {\r\n\treturn new Project(item);\r\n}\r\n\r\nconst projectAPI = {\r\n\tget(page = 1, limit = 20) {\r\n\t\treturn (\r\n\t\t\tfetch(`${url}?_page=${page}&_limit=${limit}&_sort=name`)\r\n\t\t\t\t// .then(delay(600))\r\n\t\t\t\t.then(checkStatus)\r\n\t\t\t\t.then(parseJSON)\r\n\t\t\t\t.then(convertToProjectModels)\r\n\t\t\t\t.catch((error: TypeError) => {\r\n\t\t\t\t\tconsole.log(\"log client error\" + error);\r\n\t\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\t\"There was an error retrieving the projects. Try Again!\"\r\n\t\t\t\t\t);\r\n\t\t\t\t})\r\n\t\t);\r\n\t},\r\n\r\n\tput(project: Project) {\r\n\t\treturn fetch(`${url}/${project.id}`, {\r\n\t\t\tmethod: \"PUT\",\r\n\t\t\tbody: JSON.stringify(project),\r\n\t\t\theaders: {\r\n\t\t\t\t\"Content-Type\": \"application/json\",\r\n\t\t\t},\r\n\t\t})\r\n\t\t\t.then(checkStatus)\r\n\t\t\t.then(parseJSON)\r\n\t\t\t.catch((error: TypeError) => {\r\n\t\t\t\tconsole.log(\"log client error \" + error);\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"There was an error updating the project. Please try again.\"\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t},\r\n};\r\n\r\nexport { projectAPI };\r\n"],"mappings":"AAAA,SAASA,OAAT,QAAwB,WAAxB;AACA,MAAMC,OAAO,GAAG,uBAAhB;AACA,MAAMC,GAAG,GAAI,GAAED,OAAQ,WAAvB,C,CACA;;AAEA,SAASE,6BAAT,CAAuCC,MAAvC,EAAuD;EACtD,QAAQA,MAAR;IACC,KAAK,GAAL;MACC,OAAO,qBAAP;;IACD,KAAK,GAAL;MACC,OAAO,oDAAP;;IACD;MACC,OAAO,iEAAP;EANF;AAQA;;AAED,SAASC,WAAT,CAAqBC,QAArB,EAAoC;EACnC,IAAIA,QAAQ,CAACC,EAAb,EAAiB;IAChB,OAAOD,QAAP;EACA,CAFD,MAEO;IACN,MAAME,aAAa,GAAG;MACrBJ,MAAM,EAAEE,QAAQ,CAACF,MADI;MAErBK,UAAU,EAAEH,QAAQ,CAACG,UAFA;MAGrBP,GAAG,EAAEI,QAAQ,CAACJ;IAHO,CAAtB;IAKAQ,OAAO,CAACC,GAAR,CAAa,0BAAyBC,IAAI,CAACC,SAAL,CAAeL,aAAf,CAA8B,EAApE;IAEA,IAAIM,YAAY,GAAGX,6BAA6B,CAACK,aAAa,CAACJ,MAAf,CAAhD;IACA,MAAM,IAAIW,KAAJ,CAAUD,YAAV,CAAN;EACA;AACD;;AAED,SAASE,SAAT,CAAmBV,QAAnB,EAAuC;EACtC,OAAOA,QAAQ,CAACW,IAAT,EAAP;AACA,C,CAED;;;AACA,SAASC,KAAT,CAAeC,EAAf,EAA2B;EAC1B,OAAO,UAAUC,CAAV,EAAgC;IACtC,OAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAaC,UAAU,CAAC,MAAMD,OAAO,CAACF,CAAD,CAAd,EAAmBD,EAAnB,CAAnC,CAAP;EACA,CAFD;AAGA;;AAED,SAASK,sBAAT,CAAgCC,IAAhC,EAAwD;EACvD,IAAIC,QAAmB,GAAGD,IAAI,CAACE,GAAL,CAASC,qBAAT,CAA1B;EACA,OAAOF,QAAP;AACA;;AAED,SAASE,qBAAT,CAA+BC,IAA/B,EAAmD;EAClD,OAAO,IAAI7B,OAAJ,CAAY6B,IAAZ,CAAP;AACA;;AAED,MAAMC,UAAU,GAAG;EAClBC,GAAG,GAAuB;IAAA,IAAtBC,IAAsB,uEAAf,CAAe;IAAA,IAAZC,KAAY,uEAAJ,EAAI;IACzB,OACCC,KAAK,CAAE,GAAEhC,GAAI,UAAS8B,IAAK,WAAUC,KAAM,aAAtC,CAAL,CACC;IADD,CAEEE,IAFF,CAEO9B,WAFP,EAGE8B,IAHF,CAGOnB,SAHP,EAIEmB,IAJF,CAIOX,sBAJP,EAKEY,KALF,CAKSC,KAAD,IAAsB;MAC5B3B,OAAO,CAACC,GAAR,CAAY,qBAAqB0B,KAAjC;MACA,MAAM,IAAItB,KAAJ,CACL,wDADK,CAAN;IAGA,CAVF,CADD;EAaA,CAfiB;;EAiBlBuB,GAAG,CAACC,OAAD,EAAmB;IACrB,OAAOL,KAAK,CAAE,GAAEhC,GAAI,IAAGqC,OAAO,CAACC,EAAG,EAAtB,EAAyB;MACpCC,MAAM,EAAE,KAD4B;MAEpCC,IAAI,EAAE9B,IAAI,CAACC,SAAL,CAAe0B,OAAf,CAF8B;MAGpCI,OAAO,EAAE;QACR,gBAAgB;MADR;IAH2B,CAAzB,CAAL,CAOLR,IAPK,CAOA9B,WAPA,EAQL8B,IARK,CAQAnB,SARA,EASLoB,KATK,CASEC,KAAD,IAAsB;MAC5B3B,OAAO,CAACC,GAAR,CAAY,sBAAsB0B,KAAlC;MACA,MAAM,IAAItB,KAAJ,CACL,4DADK,CAAN;IAGA,CAdK,CAAP;EAeA;;AAjCiB,CAAnB;AAoCA,SAASe,UAAT"},"metadata":{},"sourceType":"module"}